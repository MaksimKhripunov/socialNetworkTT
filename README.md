# socialNetworkTT
все запросы задокументированы здесь:

http://localhost:8080/swagger-ui/index.html

Пример curl на регистрацию

curl -X 'POST' \
  'http://localhost:8080/api/register' \
  -H 'accept: */*' \
  -H 'Content-Type: application/json' \
  -d '{
  "pwd": "maksim",
  "firstname": "maksim",
  "lastname": "maksim",
  "username": "maks",
  "email": "khripunov.mak@mail.ru"
}'

Пример curl на просмотр своих друзей

curl -X 'GET' \
  'http://localhost:8080/api/friends' \
  -H 'accept: application/json' \
  -H 'Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJzZWxmIiwic3ViIjoibWFrcyIsImV4cCI6MTY5NzQyMDAwNiwiaWF0IjoxNjk3Mzg0MDA2LCJzY29wZSI6Ik1BS1MifQ.DEH792JcWMyx3einXqO1wbyMC0IgxnPXRC2zhWcf9VdLyTksYsGCAvY35SycxmK96hgYan6xhObw-_9LBYkyDAy5kDR5M59eK6pJ2ok1WcjUfIBgU_MprnA6AuCJwT_aCnMMis0hnHMdk8bV7OhwdrhcwBHl-bybKEB2W4OCJMRyJsLokhWsQ-P-h5rgU5o1NKVcghsSvqlP5qmdI_4sT-PsAD6f7bTzd9du-m-WjL0_fsjFqq1ypPjj1ecmwFuj5kY9kGGtSyyhbkNxhMohOGef5FWzjUTysFgiEIebP8XMZck0NzSIN_s_VPxM2LdOn9CjPxIff_0pNGyirXecVw'
 
 Пример ответа

[
  "string"
]

Были выполнены доп. задания: 
1. возможность добавлять других пользователей в
друзья, а также просматривать список своих друзей. Критерии:
■ есть API, позволяющий просматривать друзей, а также
добавлять в друзья другого пользователя;
■ есть возможность ограничивать получение сообщений
только своим кругом друзей;
■ есть возможность просматривать друзей другого
пользователя, и, соответственно, возможность скрывать
свой список друзей.

2. использование базы данных (PostgreSQL или MongoDB) для хранения
данных о пользователях и переписках между ними;
3. документирование запросов через Swagger;

Описание работы приложения:
Приложение позволяет зарегистрировать пользователя, записать его в бд (PostgreSQL), отправлять ссылку на почту для подтверждения аккаунта, хэшировать пароли, залогиниться(Геенерируется JWT токен, который передаётся в хэдерах).
Хранит данные о сессиях пользователей, в Spring Security разрешны для всех ссылки на регистрацию, логин, cваггер, подтверждение аккаунта и точек для вебсокетов. Остальные требуют аунтетификации.
При разлогине предыдущая сессия становится неактивной и происходит инвалидация действующего JWT токена.
Пользователь может обновить данные, при обновление email приходит сообщение на новую почту, требующее подтверждения.
Пользователь может удалить аккаунт. В течениу 30-60 дней он может вернуть своему аккаунту статус активный, для этого необходимо авторизоваться под своим логином.
PGagent удаляет все неактивные аккаунты в конце каждого месяца, если дата восстановления аккаунта истекла.
Пользователь может отправлять сообщения другим пользователям и себе, а также просматривать историю сообщений.
В приложение используются вебсокеты.
Реализована возможность добавлять пользователей в друзья, ограничивать отправку сообщений, скрывать друзей и просматривать список друзей других пользователей.

 Таблицы в бд:
 users - пользователи;
 spring_session, spring_session_attributes - сессии пользователей;
 messages - сообщения пользователей;
 chats - чаты;
 friends - друзья;
 invalid_tokens - инвалидированные токены.

